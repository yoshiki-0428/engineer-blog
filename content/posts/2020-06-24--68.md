---
template: post
title: ã€Reactor.netty x Springã€‘ ç’°å¢ƒå¤‰æ•°ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹
slug: reactor-netty-spring
draft: false
date: 2020-06-24T09:00:00Z
category: Programming
tags:
  - Reactor Netty
  - Spring
socialImage: https://ucarecdn.com/c888768a-1a82-40ed-8e22-90ba29c5e962/
---

# ã¯ã˜ã‚ã«

Spring 5ã®WebFluxã‹ã‚‰å°å…¥ã•ã‚Œã¦ã„ã‚‹Reactor.nettyã®Webã‚µãƒ¼ãƒã§ã™ãŒã€ç’°å¢ƒå¤‰æ•°ã§Connectionæ•°ã‚„æ¥ç¶šå¾…ã¡æ™‚é–“ãªã©ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ãã¾ã™ã€‚

# TR;TD

çµè«–ã€Javaã®å®Ÿè¡Œå¼•æ•°ã®å¾Œã‚ã«`Java Ops`ã‚’è¨­å®šã™ã‚‹ã¨Webã‚µãƒ¼ãƒã«åæ˜ ã•ã‚Œã¾ã™ã€‚

```
java hoge.jar 
    -Dreactor.netty.pool.leasingStrategy=lifo
    -Dreactor.netty.pool.maxConnections=200
    -Dreactor.netty.pool.maxIdleTime=60000
```
> ç’°å¢ƒå¤‰æ•°ã«åæ˜ ã—ãŸã‚Šã€ymlã«å®šç¾©ã‚‚ã—ã¾ã—ãŸãŒã€ãã¡ã‚‰ã§ã¯åæ˜ ã•ã‚Œãªã‹ã£ãŸã§ã™


### è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹

[ReactorNetty.java](https://github.com/reactor/reactor-netty/blob/master/src/main/java/reactor/netty/ReactorNetty.java#L75-L155) ã®è¨­å®šã‚’ãƒ‡ãƒãƒƒã‚°ã§æ±‚ã‚ã¦ã‚‚ã„ã„ã§ã™ãŒã€è¨­å®šã•ã‚Œã¦ã‚‹ã‹ã©ã†ã‹Reactor.nettyã®ãƒ­ã‚°ã‚’å‡ºã—ã¦ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚

æ‰‹é †çš„ã«ã¯reactor.nettyã®ãƒ­ã‚°ã‚’DEBUGã«ã—ãŸã‚‰å®Œäº†ã§ã™

```yml:application.yml
logging:
  level:
    root: INFO
    reactor.netty.resources: DEBUG
```

ã“ã‚“ãªæ„Ÿã˜ã®ãƒ­ã‚°ãŒå‡ºã‚‹ã¯ãšã§ã™ã€‚

```
2020-06-30 19:09:46.129 DEBUG 65391 --- [ioEventLoop-5-1] 
r.n.resources.PooledConnectionProvider   : Creating a new client pool
[PoolFactory {maxConnections=200, pendingAcquireMaxCount=-1, 
pendingAcquireTimeout=45000, maxIdleTime=60000, maxLifeTime=-1, metricsEnabled=false}] for [xxx.xxx.xxx:443]
```

å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ğŸ¤—

# å‚è€ƒURL

- [Reactor Netty Reference](https://projectreactor.io/docs/netty/release/reference/index.html)
- [Reactor Netty GitHub](https://github.com/reactor/reactor-netty)
- [GitHub issue](https://github.com/reactor/reactor-netty/issues/938)