{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/try-eventsource-client","result":{"data":{"markdownRemark":{"id":"355c4f39-c9ba-508b-bd79-5433aef4730a","html":"<h1 id=\"はじめに\" style=\"position:relative;\"><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\" aria-label=\"はじめに permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>はじめに</h1>\n<p>今の案件でリアルタイム処理をする要件があり、<a href=\"https://developer.mozilla.org/ja/docs/Web/API/Server-sent_events/Using_server-sent_events\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SSE（Server Sent Event）</a>のEventSource Clientライブラリを色々比較してみたので、これからクライアントで検討する際は参考に！</p>\n<h1 id=\"内容\" style=\"position:relative;\"><a href=\"#%E5%86%85%E5%AE%B9\" aria-label=\"内容 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>内容</h1>\n<h2 id=\"eventsource\" style=\"position:relative;\"><a href=\"#eventsource\" aria-label=\"eventsource permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EventSource</h2>\n<p>まずネイティブEventSourceはMozillaが提供しているこちらです。<a href=\"https://developer.mozilla.org/ja/docs/Web/API/EventSource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ネイティブEventSource</a> なのでTypeScriptも対応しているし、Corsの認証系もばっちりです。ただし、IEは非対称なので注意が必要。</p>\n<p><img src=\"https://ucarecdn.com/966c5118-280c-4680-a657-8353e1977e83/\"></p>\n<blockquote>\n<p>IEなにそれ。おいしいの？？</p>\n</blockquote>\n<p>ただし、Jestでテストコードを実行するときに少し手間取るのでそこが注意点です。</p>\n<p><a href=\"/posts/jest-eventsource\">JestでEventSourceを実行可能にする</a></p>\n<h2 id=\"fetchタイプのee\" style=\"position:relative;\"><a href=\"#fetch%E3%82%BF%E3%82%A4%E3%83%97%E3%81%AEee\" aria-label=\"fetchタイプのee permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>fetchタイプのEE</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">This library is a pure JavaScript implementation of the EventSource client. \nThe API aims to be W3C compatible.\n\nYou can use it with Node.js or as a browser polyfill for browsers \nthat don&#39;t have native EventSource support.</code></pre></div>\n<p>ブラウザ差分を埋めた（Polyfillした）ライブラリなようです。こちらは使用したときはCORS問題が発生してうまく使えなかったです。。</p>\n<p>TypeScriptで使用したので普通にJavaScriptで使用する分には問題なく使えるかもしれません（未検証）</p>\n<p><a href=\"https://github.com/EventSource/eventsource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/EventSource/eventsource</a></p>\n<h2 id=\"複数ブラウザ対応のee\" style=\"position:relative;\"><a href=\"#%E8%A4%87%E6%95%B0%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E5%AF%BE%E5%BF%9C%E3%81%AEee\" aria-label=\"複数ブラウザ対応のee permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>複数ブラウザ対応のEE</h2>\n<p>こちらも選ぶ際に検討しましたが、TypeScriptが標準で対応されていなかったので使用には至りませんでした。</p>\n<p><a href=\"https://github.com/Yaffle/EventSource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/Yaffle/EventSource</a></p>\n<h1 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h1>\n<h2 id=\"比べるよ\" style=\"position:relative;\"><a href=\"#%E6%AF%94%E3%81%B9%E3%82%8B%E3%82%88\" aria-label=\"比べるよ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>比べるよ</h2>\n<p>比べてみました。結局CORS問題が解決できないとサーバと通信できないので私達は<strong>ネイティブEEを選択しました</strong>。</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>ネイティブEE</th>\n<th>Yaffle/EventSource</th>\n<th>EventSource/eventsource</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>TypeScript対応</td>\n<td>○</td>\n<td>☓</td>\n<td>○</td>\n</tr>\n<tr>\n<td>CORS対応</td>\n<td>○</td>\n<td>? (未検証)</td>\n<td>☓ (TSのみの可能性)</td>\n</tr>\n<tr>\n<td>複数ブラウザ対応</td>\n<td>☓（IE）</td>\n<td>○</td>\n<td>? (未検証)</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"参考url\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83url\" aria-label=\"参考url permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考URL</h1>\n<ul>\n<li><a href=\"https://github.com/EventSource/eventsource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">EventSource/eventsource</a></li>\n<li><a href=\"https://github.com/Yaffle/EventSource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Yaffle/EventSource</a></li>\n<li><a href=\"https://developer.mozilla.org/ja/docs/Web/API/EventSource\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ネイティブEventSource</a></li>\n</ul>","fields":{"slug":"/posts/try-eventsource-client","tagSlugs":["/tags/sse/","/tags/event-source/"]},"frontmatter":{"date":"2020-06-20T09:00:00.000Z","updatedDate":null,"tags":["SSE","EventSource"],"title":"ネイティブEventSourceクライアントとその他EventSourceクライアントを試してみた結果","socialImage":"https://ucarecdn.com/c888768a-1a82-40ed-8e22-90ba29c5e962/","category":"Frontend"},"excerpt":"はじめに 今の案件でリアルタイム処理をする要件があり、SSE（Server Sent Event）のEventSource Clientライブラリを色々比較してみたので、これからクライアントで検討する際は参考に！ 内容 EventSource まずネイティブEventSourc…","tableOfContents":"<ul>\n<li><a href=\"/posts/try-eventsource-client/#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\">はじめに</a></li>\n<li>\n<p><a href=\"/posts/try-eventsource-client/#%E5%86%85%E5%AE%B9\">内容</a></p>\n<ul>\n<li><a href=\"/posts/try-eventsource-client/#eventsource\">EventSource</a></li>\n<li><a href=\"/posts/try-eventsource-client/#fetch%E3%82%BF%E3%82%A4%E3%83%97%E3%81%AEee\">fetchタイプのEE</a></li>\n<li><a href=\"/posts/try-eventsource-client/#%E8%A4%87%E6%95%B0%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E5%AF%BE%E5%BF%9C%E3%81%AEee\">複数ブラウザ対応のEE</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/posts/try-eventsource-client/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></p>\n<ul>\n<li><a href=\"/posts/try-eventsource-client/#%E6%AF%94%E3%81%B9%E3%82%8B%E3%82%88\">比べるよ</a></li>\n</ul>\n</li>\n<li><a href=\"/posts/try-eventsource-client/#%E5%8F%82%E8%80%83url\">参考URL</a></li>\n</ul>"}},"pageContext":{"slug":"/posts/try-eventsource-client"}},"staticQueryHashes":["1552397463","1669302033","3314088506","401334301","554596625","82304099"]}