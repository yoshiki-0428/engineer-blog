{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/start-gatsby-blog-tableofcontent","result":{"data":{"markdownRemark":{"id":"a1a8463b-ad4b-510a-ae1f-102c6dec8165","html":"<h1 id=\"はじめに\" style=\"position:relative;\"><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\" aria-label=\"はじめに permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>はじめに</h1>\n<p>この記事は<a href=\"https://www.gatsbyjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Gatsby</a>というヘッドレスCMS技術で構成されています。今回は「エンジニア初心者でもできる」を前提に以下の構成で記事を作成していこうと思います。</p>\n<ul>\n<li><a href=\"https://tech-blog.yoshikiohashi.dev/posts/start-gatsby-blog/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Gatsby始めるまで</a></li>\n<li><a href=\"https://tech-blog.yoshikiohashi.dev/posts/start-gatsby-blog-share/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GatsbyにShare機能、OGPタグをつける</a></li>\n<li><a href=\"https://tech-blog.yoshikiohashi.dev/posts/start-gatsby-blog-add-tags\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">タグ機能、カテゴリ機能をつける（基礎編）</a></li>\n<li><a href=\"https://tech-blog.yoshikiohashi.dev/posts/start-gatsby-blog-add-tags-application\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">タグ機能、カテゴリ機能をつける（応用編）</a></li>\n<li><a href=\"https://tech-blog.yoshikiohashi.dev/posts/start-gatsby-blog-tableofcontent\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GatsbyにTableOfContents（目次）をつける</a>（本記事）</li>\n<li><a href=\"https://tech-blog.yoshikiohashi.dev/posts/start-gatsby-blog-darkmode\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">DarkModeをつける</a></li>\n</ul>\n<h1 id=\"内容\" style=\"position:relative;\"><a href=\"#%E5%86%85%E5%AE%B9\" aria-label=\"内容 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>内容</h1>\n<p>前回はタグ一覧と記事一覧のコンポーネントを同時に出すGraphQLクエリーの応用まで行いました。</p>\n<p>今回はブログで欠かせないTableOfContents（目次）の実装方法のご紹介です。全く難しくないのでササッと行きましょう！</p>\n<p><img src=\"https://ucarecdn.com/94b024f1-760a-471c-875c-0ba1f4a2ed71/\"></p>\n<h2 id=\"クエリー\" style=\"position:relative;\"><a href=\"#%E3%82%AF%E3%82%A8%E3%83%AA%E3%83%BC\" aria-label=\"クエリー permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>クエリー</h2>\n<p>超簡単です。記事を取得しているクエリーに<strong>tableOfContents</strong>を付け足すだけです。エディタで結果を確認してみましょう。</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\">  <span class=\"token keyword\">query</span> PostBySlug<span class=\"token punctuation\">(</span><span class=\"token variable\">$slug</span><span class=\"token punctuation\">:</span> String<span class=\"token operator\">!</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    markdownRemark<span class=\"token punctuation\">(</span><span class=\"token attr-name\">fields</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">slug</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$slug</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      id\n      html\n      fields <span class=\"token punctuation\">{</span>\n        slug\n        tagSlugs\n      <span class=\"token punctuation\">}</span>\n      frontmatter <span class=\"token punctuation\">{</span>\n        date\n        description\n        tags\n        title\n        socialImage\n      <span class=\"token punctuation\">}</span>\n      tableOfContents\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"https://ucarecdn.com/d9fbac98-d126-4772-a731-dfb1b217cc57/\"></p>\n<p>このようにHTML形式のデータを取得することができました。あとは表示するだけです。</p>\n<h2 id=\"コンポーネント作成\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E4%BD%9C%E6%88%90\" aria-label=\"コンポーネント作成 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コンポーネント作成</h2>\n<p>TOCを表示するコンポーネントつくりです。</p>\n<p>ちなみになぜコンポーネントにするのか？理由は単純で</p>\n<ul>\n<li>使い回しがしやすい</li>\n<li>CSSの設定を限定的にできる</li>\n<li>パーツを好きなところに配置しやすくなる</li>\n</ul>\n<p>からです。パーツ１つ１つの依存度を下げていきましょう。</p>\n<p>下のように<strong>dangerouslySetInnerHTML={{ __html: tableOfContents }}</strong>に先程取得したHTMLデータを流し込みましょう。（CSSの設定はお好みで設定してください）</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Toc</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> tableOfContents<span class=\"token punctuation\">,</span> gridArea <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> Props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>toc<span class=\"token punctuation\">}</span> dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> __html<span class=\"token operator\">:</span> tableOfContents <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Toc<span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h1>\n<p>いかがだったでしょうか？</p>\n<p>他にも<a href=\"https://github.com/DSchau/gatsby-remark-toc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">gatsby-remark-toc</a>などのライブラリがあるみたいですが、私個人としてはこちらの方がシンプルで簡潔だと考えています。それでは次回の記事で。</p>","fields":{"slug":"/posts/start-gatsby-blog-tableofcontent","tagSlugs":["/tags/gatsby/","/tags/cms/","/tags/toc/"]},"frontmatter":{"date":"2020-05-28T22:30:41.748Z","updatedDate":null,"tags":["Gatsby","CMS","Toc"],"title":"GatsbyにTableOfContents（目次）をつける","socialImage":"https://ucarecdn.com/1c3706e0-1090-48c1-ad74-f10e9cbce307/","category":"Programming"},"excerpt":"はじめに この記事はGatsbyというヘッドレスCMS技術で構成されています。今回は「エンジニア初心者でもできる」を前提に以下の構成で記事を作成していこうと思います。 Gatsby始めるまで GatsbyにShare機能、OGPタグをつける タグ機能、カテゴリ機能をつける（基礎…","tableOfContents":"<ul>\n<li><a href=\"/posts/start-gatsby-blog-tableofcontent/#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\">はじめに</a></li>\n<li>\n<p><a href=\"/posts/start-gatsby-blog-tableofcontent/#%E5%86%85%E5%AE%B9\">内容</a></p>\n<ul>\n<li><a href=\"/posts/start-gatsby-blog-tableofcontent/#%E3%82%AF%E3%82%A8%E3%83%AA%E3%83%BC\">クエリー</a></li>\n<li><a href=\"/posts/start-gatsby-blog-tableofcontent/#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E4%BD%9C%E6%88%90\">コンポーネント作成</a></li>\n</ul>\n</li>\n<li><a href=\"/posts/start-gatsby-blog-tableofcontent/#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>"}},"pageContext":{"slug":"/posts/start-gatsby-blog-tableofcontent"}},"staticQueryHashes":["1552397463","1669302033","3314088506","401334301","554596625","82304099"]}